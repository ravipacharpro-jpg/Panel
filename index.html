<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP NEON PANEL v2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --blue: #00f3ff; --pink: #ff00ff; --green: #39ff14; --purple: #bc13fe; --bg: #080808; --card: #121212; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        .sidebar { width: 260px; background: #000; border-right: 1px solid var(--blue); padding: 20px; display: flex; flex-direction: column; box-shadow: 5px 0 15px rgba(0, 243, 255, 0.1); }
        .brand-name { font-size: 22px; font-weight: bold; color: var(--blue); text-shadow: 0 0 10px var(--blue); margin-bottom: 30px; text-align: center; }
        .nav-link { padding: 12px; cursor: pointer; border-radius: 8px; transition: 0.3s; margin: 5px 0; color: #888; display: flex; align-items: center; border-left: 3px solid transparent; }
        .nav-link:hover, .active-nav { background: rgba(0, 243, 255, 0.1); color: var(--blue); border-left: 3px solid var(--blue); }
        .nav-link i { margin-right: 15px; width: 20px; }

        .main { flex: 1; padding: 25px; overflow-y: auto; background: radial-gradient(circle at top right, rgba(0, 243, 255, 0.05), transparent); }
        .card { background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid #222; margin-bottom: 20px; transition: 0.3s; }
        .card:hover { border-color: var(--blue); box-shadow: 0 0 15px rgba(0, 243, 255, 0.1); }
        
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; }
        .stat-box { text-align: center; }
        .stat-box h3 { font-size: 12px; color: #666; margin: 0; }
        .stat-box p { font-size: 22px; margin: 10px 0; font-weight: bold; color: var(--blue); }

        input, select { width: 100%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid #333; color: white; border-radius: 8px; outline: none; box-sizing: border-box; }
        input:focus { border-color: var(--pink); box-shadow: 0 0 10px var(--pink); }
        .btn { width: 100%; padding: 12px; background: transparent; border: 1px solid var(--blue); color: var(--blue); cursor: pointer; border-radius: 8px; font-weight: bold; text-transform: uppercase; margin-top: 10px; transition: 0.3s; }
        .btn:hover { background: var(--blue); color: black; box-shadow: 0 0 20px var(--blue); }

        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { text-align: left; color: #555; padding: 10px; border-bottom: 1px solid #222; }
        td { padding: 12px 10px; border-bottom: 1px solid #111; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 10px; border: 1px solid; }
        .active-key { color: var(--green); border-color: var(--green); }
        .banned-key { color: red; border-color: red; }

        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .tg-btn { position: fixed; bottom: 30px; right: 30px; width: 55px; height: 55px; background: #0088cc; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 25px; color: white; box-shadow: 0 0 15px #0088cc; z-index: 999; text-decoration: none; border: 2px solid white; transition: 0.3s; }
        .tg-btn:hover { transform: scale(1.1); }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <!-- Login Page -->
    <div id="login-overlay">
        <div class="card" style="width: 320px; text-align: center; border-color: var(--blue);">
            <h2 style="color: var(--blue); text-shadow: 0 0 10px var(--blue);">VIP NEON LOGIN</h2>
            <input type="text" id="log-user" placeholder="Username">
            <input type="password" id="log-pass" placeholder="Password">
            <button class="btn" onclick="app.login()">ENTER PANEL</button>
            <p style="font-size: 10px; color: #444; margin-top: 10px;">Security: User + Device Encrypted</p>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div id="disp-brand" class="brand-name">VIP PANEL</div>
        <div class="nav-link active-nav" onclick="app.tab('dash')"><i class="fas fa-home"></i> Dashboard</div>
        <div class="nav-link" onclick="app.tab('keys')"><i class="fas fa-key"></i> Key Manager</div>
        <div class="nav-link owner-only hidden" onclick="app.tab('admin')"><i class="fas fa-user-shield"></i> Manage Admins</div>
        <div class="nav-link" onclick="app.tab('settings')"><i class="fas fa-cog"></i> Settings</div>
        <div class="nav-link" onclick="app.logout()" style="margin-top: auto; color: #ff4444;"><i class="fas fa-power-off"></i> Logout</div>
    </div>

    <!-- Main Content Area -->
    <div class="main">
        <!-- Dashboard Tab -->
        <div id="tab-dash">
            <h1>Hello, <span id="disp-user" style="color: var(--pink);">...</span></h1>
            <div class="stats">
                <div class="card stat-box"><h3>Account Role</h3><p id="disp-role">-</p></div>
                <div class="card stat-box"><h3>Server Status</h3><p style="color:var(--green)">ONLINE</p></div>
                <div class="card stat-box"><h3>Total Keys</h3><p id="disp-keys">0</p></div>
            </div>
            <div class="card" style="border-left: 5px solid var(--purple);">
                <h3 style="color: var(--purple); margin:0;">System Firewall</h3>
                <p style="font-size: 13px; color: #888; margin-top: 10px;">
                    <i class="fas fa-check-circle" style="color:var(--green)"></i> Anti-HttpCanary Active | 
                    <i class="fas fa-check-circle" style="color:var(--green)"></i> Anti-GG Active | 
                    <i class="fas fa-check-circle" style="color:var(--green)"></i> Anti-Termux Active
                </p>
            </div>
        </div>

        <!-- Key Manager Tab -->
        <div id="tab-keys" class="hidden">
            <div class="card">
                <h3 style="color: var(--blue);">Generate New VIP Key</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <input type="text" id="key-name" placeholder="Customer Name">
                    <select id="key-time">
                        <option value="2h">2 Hours</option>
                        <option value="5h">5 Hours</option>
                        <option value="1d">1 Day</option>
                        <option value="7d">7 Days</option>
                        <option value="30d">30 Days</option>
                        <option value="60d">60 Days</option>
                    </select>
                    <select id="key-limit">
                        <option value="1">1 Device (HWID)</option>
                        <option value="2">2 Devices (Dual)</option>
                        <option value="5">5 Devices</option>
                    </select>
                    <div class="owner-admin-only hidden" style="display: flex; align-items: center; gap:10px;">
                        <input type="checkbox" id="key-master" style="width: 20px;"> <label style="color: gold; font-weight: bold;">MASTER KEY</label>
                    </div>
                </div>
                <button class="btn" onclick="app.generateKey()">Generate VIP Key</button>
            </div>

            <div class="card">
                <h3>My Keys List</h3>
                <table>
                    <thead><tr><th>Name</th><th>Key Code</th><th>Status</th><th>Devices</th><th>Actions</th></tr></thead>
                    <tbody id="key-list"></tbody>
                </table>
            </div>
        </div>

        <!-- Admin Management Tab -->
        <div id="tab-admin" class="hidden">
            <div class="card">
                <h3>Create Staff Account</h3>
                <input type="text" id="new-user" placeholder="Username">
                <input type="password" id="new-pass" placeholder="Password">
                <select id="new-role">
                    <option value="admin">Admin</option>
                    <option value="reseller">Reseller</option>
                </select>
                <p style="font-size: 11px; color:var(--pink)">*First create this user in Firebase Auth with (username@panel.com)</p>
                <button class="btn" onclick="app.createAccount()">Link Account To Panel</button>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="tab-settings" class="hidden">
            <div class="card">
                <h3>Branding Settings</h3>
                <label>Change Dashboard Brand Name:</label>
                <input type="text" id="set-brand" placeholder="New Brand Name">
                <label>Change Your Support Telegram:</label>
                <input type="text" id="set-tg" placeholder="https://t.me/yourusername">
                <button class="btn" onclick="app.saveSettings()">Save Branding</button>
            </div>
            <div class="card" style="border-color: var(--pink);">
                <h3>Security Settings</h3>
                <label>New Password:</label>
                <input type="password" id="set-pass" placeholder="Enter new password">
                <button class="btn" onclick="app.changePass()" style="border-color: var(--pink); color:var(--pink);">Update Password</button>
            </div>
        </div>
    </div>

    <!-- Floating Support -->
    <a href="#" id="tg-support" class="tg-btn" target="_blank"><i class="fab fa-telegram-plane"></i></a>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
        // --- YOUR CONFIG (UPDATED) ---
        const firebaseConfig = {
            apiKey: "AIzaSyDRpY5f4_SPuuspfed3UkxG99gByr9rqH8",
            authDomain: "host-panel-fd943.firebaseapp.com",
            projectId: "host-panel-fd943",
            storageBucket: "host-panel-fd943.firebasestorage.app",
            messagingSenderId: "75573266168",
            appId: "1:75573266168:web:1db02b2665c4431e495d0d"
        };
        // --- CONFIG END ---

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const app = {
            user: null,
            userData: null,

            login: function() {
                const u = document.getElementById('log-user').value;
                const p = document.getElementById('log-pass').value;
                if(!u || !p) return alert("Fill all fields");
                auth.signInWithEmailAndPassword(u + "@panel.com", p)
                    .catch(e => alert("Error: " + e.message));
            },

            logout: function() { auth.signOut().then(() => location.reload()); },

            tab: function(t) {
                ['dash','keys','admin','settings'].forEach(id => {
                    document.getElementById('tab-'+id).classList.add('hidden');
                });
                document.getElementById('tab-'+t).classList.remove('hidden');
                document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active-nav'));
                event.currentTarget.classList.add('active-nav');
            },

            generateKey: function() {
                const name = document.getElementById('key-name').value;
                const isMaster = document.getElementById('key-master').checked;
                if(!name) return alert("Enter Customer Name!");

                const key = `${name.toUpperCase()}-${isMaster ? 'MASTER' : 'VIP'}-${Math.floor(1000+Math.random()*9000)}`;
                db.collection("keys").add({
                    key: key, customer: name,
                    type: isMaster ? "master" : "standard",
                    duration: document.getElementById('key-time').value,
                    limit: isMaster ? 999999 : parseInt(document.getElementById('key-limit').value),
                    adminId: this.user.uid, status: "active",
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                }).then(() => { 
                    alert("âœ… Key Generated: " + key); 
                    document.getElementById('key-name').value = "";
                });
            },

            saveSettings: function() {
                const b = document.getElementById('set-brand').value;
                const t = document.getElementById('set-tg').value;
                db.collection("users").doc(this.user.uid).update({ brandName: b, telegram: t })
                    .then(() => alert("Settings Updated!"));
            },

            changePass: function() {
                const p = document.getElementById('set-pass').value;
                if(p.length < 6) return alert("Min 6 chars");
                auth.currentUser.updatePassword(p).then(() => alert("Password Changed Successfully!"));
            },

            createAccount: function() {
                const u = document.getElementById('new-user').value;
                const r = document.getElementById('new-role').value;
                alert("Please go to Firebase Console > Auth and add " + u + "@panel.com first. Then manually add the UID in Firestore 'users' collection with role: " + r);
            }
        };

        // Auth Listener
        auth.onAuthStateChanged(async (u) => {
            if (u) {
                app.user = u;
                document.getElementById('login-overlay').style.display = 'none';
                
                const doc = await db.collection("users").doc(u.uid).get();
                if(!doc.exists) {
                    alert("Account found but not linked to Panel Database. Contact Owner.");
                    return;
                }
                
                const data = doc.data();
                app.userData = data;
                
                // Display Info
                document.getElementById('disp-user').innerText = data.username || "Staff";
                document.getElementById('disp-role').innerText = data.role.toUpperCase();
                document.getElementById('disp-brand').innerText = data.brandName || "VIP PANEL";
                
                if(data.role === 'owner') {
                    document.querySelectorAll('.owner-only').forEach(el => el.classList.remove('hidden'));
                    document.querySelectorAll('.owner-admin-only').forEach(el => el.classList.remove('hidden'));
                    document.getElementById('tg-support').href = data.telegram || "#";
                } else if(data.role === 'admin') {
                    document.querySelectorAll('.owner-admin-only').forEach(el => el.classList.remove('hidden'));
                    // Admins see Owner's TG
                    const ownerSnap = await db.collection("users").where("role", "==", "owner").limit(1).get();
                    if(!ownerSnap.empty) document.getElementById('tg-support').href = ownerSnap.docs[0].data().telegram;
                } else {
                    // Resellers see their Admin's TG
                    const up = await db.collection("users").doc(data.createdBy || "OWNER").get();
                    document.getElementById('tg-support').href = up.exists ? up.data().telegram : "#";
                }

                // Load My Keys
                db.collection("keys").where("adminId", "==", u.uid).onSnapshot(snap => {
                    const list = document.getElementById('key-list');
                    list.innerHTML = "";
                    document.getElementById('disp-keys').innerText = snap.size;
                    snap.forEach(d => {
                        const k = d.data();
                        list.innerHTML += `<tr>
                            <td>${k.customer}</td>
                            <td style="color:var(--blue); font-family:monospace">${k.key}</td>
                            <td><span class="status-badge ${k.status === 'active' ? 'active-key' : 'banned-key'}">${k.status}</span></td>
                            <td>${k.limit}</td>
                            <td>
                                <i class="fas fa-trash" onclick="if(confirm('Delete?')) db.collection('keys').doc('${d.id}').delete()" style="color:red; cursor:pointer"></i>
                            </td>
                        </tr>`;
                    });
                });
            }
        });
    </script>
</body>
</html>